<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/blog/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/blog/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/blog/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="网易先知&amp;&amp;网易七鱼前端团队博客">
<meta property="og:url" content="http://nsfi.github.io/blog/index.html">
<meta property="og:site_name" content="网易先知&amp;&amp;网易七鱼前端团队博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="网易先知&amp;&amp;网易七鱼前端团队博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blog/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://nsfi.github.io/blog/"/>





  <title>网易先知&&网易七鱼前端团队博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/blog/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">网易先知&&网易七鱼前端团队博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/blog/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/blog/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://nsfi.github.io/blog/blog/2017/12/18/Nodejs实现静态资源服务器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="giflee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="网易先知&&网易七鱼前端团队博客">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/12/18/Nodejs实现静态资源服务器/" itemprop="url">Nodejs实现静态资源服务器</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-18T11:19:24+08:00">
                2017-12-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>Nodejs构建静态服务器需要考虑的几个点：</p>
</blockquote>
<ul>
<li>路径分析</li>
<li>不同类型的文件展示</li>
<li>增加文件夹逻辑 形如 ‘<a href="http://xxx.com/a/b/" target="_blank" rel="noopener">http://xxx.com/a/b/</a>‘ , 则查找b目录下是否有index.html,如果有就显示，如果没有就列出该目录下的所有文件及文件夹，并可以进一步访问</li>
<li>增加缓存机制</li>
</ul>
<h2 id="路由解析"><a href="#路由解析" class="headerlink" title="路由解析"></a>路由解析</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa()</span><br><span class="line"></span><br><span class="line">app.use( <span class="keyword">async</span> ( ctx ) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(ctx.request.path);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">3000</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'app started at port 3000 ...'</span>);</span><br></pre></td></tr></table></figure>
<h2 id="纯文本文件查找和读取"><a href="#纯文本文件查找和读取" class="headerlink" title="纯文本文件查找和读取"></a>纯文本文件查找和读取</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">app.use( <span class="function">(<span class="params"> ctx </span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 拼接出真实路径</span></span><br><span class="line">    <span class="keyword">let</span> pathName = path.join(staticPath, ctx.request.path);</span><br><span class="line">    <span class="built_in">console</span>.log(pathName);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 读取文件</span></span><br><span class="line">    <span class="keyword">let</span> exist = fs.existsSync(pathName);</span><br><span class="line">    <span class="keyword">if</span> (exist === <span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> data = fs.readFileSync(pathName);</span><br><span class="line">        ctx.response.type = <span class="string">"html"</span>;</span><br><span class="line">        ctx.response.body = data;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        ctx.response.type = <span class="string">'text/plain'</span>;</span><br><span class="line">        ctx.response.body = <span class="string">"The request URL '"</span> + pathName + <span class="string">"' was not found on this server"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">console</span>.log(exist);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="不同类型文件的读取"><a href="#不同类型文件的读取" class="headerlink" title="不同类型文件的读取"></a>不同类型文件的读取</h2><p>MIME值制作映射表<br>MIME.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> type = &#123;</span><br><span class="line">    <span class="string">"txt"</span>: <span class="string">"text/plain"</span>,</span><br><span class="line">    <span class="string">"xml"</span>: <span class="string">"text/xml"</span>,</span><br><span class="line">    <span class="string">"html"</span>: <span class="string">"text/html"</span>,</span><br><span class="line">    <span class="string">"css"</span>: <span class="string">"text/css"</span>,</span><br><span class="line">    <span class="string">"js"</span>: <span class="string">"text/javascript"</span>,</span><br><span class="line">    <span class="string">"json"</span>: <span class="string">"application/json"</span>,</span><br><span class="line">    <span class="string">"gif"</span>: <span class="string">"image/gif"</span>,</span><br><span class="line">    <span class="string">"png"</span>: <span class="string">"image/png"</span>,</span><br><span class="line">    <span class="string">"jpeg"</span>: <span class="string">"image/jpeg"</span>,</span><br><span class="line">    <span class="string">"jpg"</span>: <span class="string">"image/jpeg"</span>,</span><br><span class="line">    <span class="string">"svg"</span>: <span class="string">"image/svg+xml"</span>,</span><br><span class="line">    <span class="string">"ico"</span>: <span class="string">"image/x-icon"</span>,</span><br><span class="line">    <span class="string">"pdf"</span>: <span class="string">"application/pdf"</span>,</span><br><span class="line">    <span class="string">"swf"</span>: <span class="string">"application/x-shockwave-flash"</span>,</span><br><span class="line">    <span class="string">"tiff"</span>: <span class="string">"image/tiff"</span>,</span><br><span class="line">    <span class="string">"wav"</span>: <span class="string">"audio/x-wav"</span>,</span><br><span class="line">    <span class="string">"wma"</span>: <span class="string">"audio/x-ms-wma"</span>,</span><br><span class="line">    <span class="string">"wmv"</span>: <span class="string">"video/x-ms-wmv"</span></span><br><span class="line">&#125;</span><br><span class="line">exports.type = type;</span><br></pre></td></tr></table></figure></p>
<p>通过映射表，根据后缀名来查找 response.type<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> findFileMIME = <span class="function"><span class="keyword">function</span> (<span class="params">pathName</span>) </span>&#123; <span class="comment">// 根据文件后缀名来判断 </span></span><br><span class="line">    <span class="keyword">let</span> filetype = path.extname(pathName).substring(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (MIME.type[filetype]) &#123;</span><br><span class="line">        <span class="keyword">return</span> MIME.type[filetype];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> data = fs.readFileSync(pathName);</span><br><span class="line">ctx.response.type = findFileMIME(pathName) || <span class="string">'text'</span>;</span><br><span class="line">ctx.response.body = data;</span><br></pre></td></tr></table></figure>
<h2 id="完整的文件和文件夹处理"><a href="#完整的文件和文件夹处理" class="headerlink" title="完整的文件和文件夹处理"></a>完整的文件和文件夹处理</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> main = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params">ctx, next</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> pathName = path.join(staticPath, ctx.request.path);</span><br><span class="line">    <span class="comment">// 判断文件路径是否存在</span></span><br><span class="line">    <span class="keyword">let</span> exist = fs.existsSync(pathName);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (exist === <span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="comment">// 判断是文件还是文件夹</span></span><br><span class="line">        <span class="keyword">var</span> stats = fs.statSync(pathName);</span><br><span class="line">        <span class="keyword">if</span> (stats.isFile()) &#123; <span class="comment">// 如果是文件， 判断文件类型， 并显示文件</span></span><br><span class="line">            <span class="keyword">let</span> data = fs.readFileSync(pathName);</span><br><span class="line">            ctx.response.type = findFileMIME(pathName) || <span class="string">'text'</span>;</span><br><span class="line">            ctx.response.body = data;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (stats.isDirectory()) &#123; <span class="comment">// 如果是文件夹, index.html or 文件列表</span></span><br><span class="line">            <span class="keyword">if</span> (!fs.existsSync(path.join(pathName, <span class="string">'index.html'</span>))) &#123; <span class="comment">// 判断是否存在 index.html</span></span><br><span class="line">                ctx.response.type = <span class="string">'html'</span>;</span><br><span class="line">                <span class="keyword">let</span> htmlbody = <span class="string">"&lt;head&gt;&lt;meta charset = 'utf-8'/&gt;&lt;/head&gt;&lt;body&gt;&lt;ul&gt;"</span>;</span><br><span class="line">                <span class="keyword">let</span> files = <span class="keyword">await</span> fs.readdir(pathName);</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">let</span> i  = <span class="number">0</span>;i&lt;files.length; i++) &#123;</span><br><span class="line">                    <span class="comment">// 排除 DS_STORE 文件</span></span><br><span class="line">                    <span class="keyword">if</span> (files[i]!== <span class="string">'.DS_Store'</span>) &#123;</span><br><span class="line">                        <span class="keyword">let</span> hreflink = path.join(ctx.request.path, files[i]);</span><br><span class="line">                        htmlbody = htmlbody + <span class="string">'&lt;li&gt;&lt;a href="'</span> + hreflink +<span class="string">'"&gt;'</span> + files[i] +<span class="string">'&lt;/a&gt;&lt;/li&gt;'</span>;</span><br><span class="line">                        <span class="built_in">console</span>.log(path.extname(files[i]));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                htmlbody = htmlbody + <span class="string">'&lt;/ul&gt;&lt;/body&gt;'</span>;</span><br><span class="line">                ctx.response.body = htmlbody;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                ctx.response.redirect(path.join(ctx.request.path, <span class="string">'index.html'</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        ctx.response.type = <span class="string">'text/plain'</span>;</span><br><span class="line">        ctx.response.body = <span class="string">"The request URL '"</span> + pathName + <span class="string">"' was not found on this server"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">app.use(main);</span><br></pre></td></tr></table></figure>
<h2 id="增加缓存机制"><a href="#增加缓存机制" class="headerlink" title="增加缓存机制"></a>增加缓存机制</h2><p>目的：为了缓解请求量增大对服务器的压力，采用缓存机制能够减少对服务器文件的读写。</p>
<p>属性：</p>
<ul>
<li><p>request </p>
<ul>
<li>If-Modified-Since：第一次请求时response 中的 Last-Modified</li>
<li>If-Nont-Match： 浏览器第一次请求时 response 中的 ETag</li>
</ul>
</li>
<li><p>response</p>
<ul>
<li>Cache-Control: max-age=【秒】 || no-cache || no-store || public || private</li>
<li>ETag: 当前资源在服务器的唯一标志符</li>
<li>Expires</li>
<li>Last-Modified: 告诉浏览器当前资源的最后修改时间</li>
</ul>
</li>
</ul>
<p>HTTP 缓存策略</p>
<ul>
<li><strong>本地缓存阶段：</strong> 先在本地查找该资源，如果存在，且资源未过期，则使用这一资源，不发送 http 请求到服务器</li>
<li><strong>协商缓存阶段：</strong> 如果在本地缓存找到对应资源，但是不知道是否过期，则发一个HTTP请求到服务器，然后服务器判断请求的资源在服务器上是否改动过，没有改动过则返回 304，让浏览器使用本地找到的资源</li>
<li><strong>缓存失败：</strong> 当服务器发现请求的资源已经修改过，或这是一个新的请求，服务器则返回该资源的数据，并返回200。如果资源未找到则返回 404</li>
</ul>
<h3 id="本地缓存阶段"><a href="#本地缓存阶段" class="headerlink" title="本地缓存阶段"></a>本地缓存阶段</h3><ul>
<li>Expires：缓存过期的绝对时间GMT，如果设置了max-age，expires会失效</li>
<li>Cache-Control：max-age=【秒】</li>
</ul>
<h3 id="前端存储方式"><a href="#前端存储方式" class="headerlink" title="前端存储方式"></a>前端存储方式</h3><ul>
<li>Cookie &lt;4k 且会在同域网络请求中进行传输，消耗网络带宽，大量Cookie会导致请求变慢，所以Cookie只保存与权限有关的用户信息。</li>
<li>LocalStorage 存储非敏感的静态数据</li>
<li>SeesionStorage 关闭浏览器后会清空</li>
</ul>
<h3 id="协商缓存阶段"><a href="#协商缓存阶段" class="headerlink" title="协商缓存阶段"></a>协商缓存阶段</h3><ul>
<li>Last-Modified === if-modified-since 最后修改时间判断</li>
<li>ETag === If-None-Match 文件的唯一符</li>
</ul>
<p>协商流程：<br>1、客户端请求一个页面（A）。<br>2、服务器返回页面A，并在给A加上一个Last-Modified/ETag。<br>3、客户端展现该页面，并将页面连同Last-Modified/ETag一起缓存。<br>4、客户再次请求页面A，并将上次请求时服务器返回的Last-Modified/ETag一起传递给服务器。<br>5、服务器检查该Last-Modified或ETag，并判断出该页面自上次客户端请求之后还未被修改，直接返回响应304和一个空的响应体。</p>
<p><strong>Etag</strong> 主要为了解决 Last-Modified 无法解决的一些问题：<br>1、一些文件也许会周期性的更改，但是他的内容并不改变(仅仅改变的修改时间)，这个时候我们并不希望客户端认为这个文件被修改了，而重新GET；<br>2、某些文件修改非常频繁，比如在秒以下的时间内进行修改，(比方说1s内修改了N次)，If-Modified-Since能检查到的粒度是s级的，这种修改无法判断(或者说UNIX记录MTIME只能精确到秒)；<br>3、某些服务器不能精确的得到文件的最后修改时间。</p>
<p><strong>Content-Length：</strong>尽管并没有在缓存中明确涉及，Content-Length头部在设置缓存策略时很重要。某些软件如果不提前获知内容的大小以留出足够空间，则会拒绝缓存该内容。</p>
<p><strong>Vary：</strong>缓存系统通常使用请求的主机和路径作为存储该资源的键。当判断一个请求是否是请求同样内容时，Vary头部可以被用来提醒缓存系统需要注意另一个附加头部。它通常被用来告诉缓存系统同样注意Accept-Encoding头部，以便缓存系统能够区分压缩和未压缩的内容。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// ************ 判断 缓存 ***********************</span></span><br><span class="line"><span class="keyword">let</span> Expires = &#123;</span><br><span class="line">    fileMatch: <span class="regexp">/^(\.gif|\.png|\.jpg|\.js|\.css|\.html)$/ig</span>,</span><br><span class="line">    maxAge: <span class="number">60</span>*<span class="number">60</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">if</span> (path.extname(ctx.request.path).match(Expires.fileMatch)) &#123;</span><br><span class="line">    <span class="comment">//获取最后修改时间 last-modified </span></span><br><span class="line">    <span class="keyword">var</span> stats = fs.statSync(pathName);</span><br><span class="line">    <span class="keyword">let</span> lastModified = stats.mtime.toUTCString();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// last-modified</span></span><br><span class="line">    <span class="keyword">if</span> (ctx.request.header[<span class="string">'if-modified-since'</span>]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ctx.request.header[<span class="string">'if-modified-since'</span>] === lastModified) &#123;</span><br><span class="line">            ctx.status = <span class="number">304</span>;</span><br><span class="line">            <span class="keyword">await</span> next();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ETag </span></span><br><span class="line">    <span class="keyword">if</span> (ctx.request.header[<span class="string">'if-none-match'</span>]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ctx.request.header[<span class="string">'if-none-match'</span>] == lastModified) &#123;</span><br><span class="line">            ctx.status = <span class="number">304</span>;</span><br><span class="line">            <span class="keyword">await</span> next();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// cache 失效 fetch new data</span></span><br><span class="line">    ctx.set(<span class="string">'ETag'</span>, lastModified);</span><br><span class="line">    ctx.set(<span class="string">'Last-Modified'</span>, lastModified);</span><br><span class="line">    ctx.status = <span class="number">200</span>;</span><br><span class="line">    <span class="keyword">let</span> data = fs.readFileSync(pathName);</span><br><span class="line">    ctx.response.type = findFileMIME(pathName) || <span class="string">'text'</span>;</span><br><span class="line">    ctx.response.body = data;</span><br><span class="line">    <span class="keyword">await</span> next();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="http://imweb.io/topic/55c6f9bac222e3af6ce235b9" target="_blank" rel="noopener">缓存策略</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://nsfi.github.io/blog/blog/2017/12/06/Less代码规范/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="giflee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="网易先知&&网易七鱼前端团队博客">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/12/06/Less代码规范/" itemprop="url">Less代码规范</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-06T16:24:22+08:00">
                2017-12-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Less代码规范"><a href="#Less代码规范" class="headerlink" title="Less代码规范"></a>Less代码规范</h1><h2 id="Less代码校验规则遵循stylelint-recommended"><a href="#Less代码校验规则遵循stylelint-recommended" class="headerlink" title="Less代码校验规则遵循stylelint:recommended"></a>Less代码校验规则遵循stylelint:recommended</h2><ul>
<li><a href="https://github.com/stylelint/stylelint-config-recommended/blob/master/index.js" target="_blank" rel="noopener">stylelint:recommended</a></li>
<li><a href="https://stylelint.io/user-guide/rules/" target="_blank" rel="noopener">stylelint详细规则</a></li>
</ul>
<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ol>
<li><a href="#terminology">术语</a><ul>
<li><a href="#rule-declaration">规则声明</a></li>
<li><a href="#selectors">选择器</a></li>
<li><a href="#properties">属性</a></li>
</ul>
</li>
<li><a href="#classify">文件分类</a></li>
<li><a href="#naming">命名规则</a></li>
<li><a href="#formatting">格式</a></li>
<li><a href="#comments">注释</a></li>
<li><a href="#order">书写顺序</a><ul>
<li><a href="#less-order">Less书写顺序</a></li>
<li><a href="#rule-order">属性书写顺序</a></li>
</ul>
</li>
<li><a href="#good">最佳实践</a></li>
<li><a href="#bad">典型错误</a></li>
<li><a href="#reference">参考</a></li>
</ol>
<p><a name="terminology"></a></p>
<h2 id="术语"><a href="#术语" class="headerlink" title="术语"></a>术语</h2><p><a name="rule-declaration"></a></p>
<h3 id="规则声明"><a href="#规则声明" class="headerlink" title="规则声明"></a>规则声明</h3><p>我们把一个（或一组）选择器和一组属性称之为 “规则声明”。举个例子：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.listing</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">18px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">1.2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a name="selectors"></a></p>
<h3 id="选择器"><a href="#选择器" class="headerlink" title="选择器"></a>选择器</h3><p>在规则声明中，“选择器” 负责选取 DOM 树中的元素，这些元素将被定义的属性所修饰。选择器可以匹配 HTML 元素，也可以匹配一个元素的类名、ID, 或者元素拥有的属性。以下是选择器的例子：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.my-element-class</span> &#123;</span><br><span class="line">  <span class="comment">/* ... */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[aria-hidden]</span> &#123;</span><br><span class="line">  <span class="comment">/* ... */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a name="properties"></a></p>
<h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3><p>最后，属性决定了规则声明里被选择的元素将得到何种样式。属性以键值对形式存在，一个规则声明可以包含一或多个属性定义。以下是属性定义的例子：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* some selector */</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f1f1f1</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a name="classify"></a></p>
<h2 id="文件分类"><a href="#文件分类" class="headerlink" title="文件分类"></a>文件分类</h2><p>页面的样式入口文件按顺序引入以下Less文件。</p>
<ol>
<li>globals.less 全局文件</li>
<li>components.less 组件</li>
<li>sections.less 区块</li>
<li>main.less 页面主体内容</li>
</ol>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* globals.less */</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">"globals/mixins"</span>;</span><br><span class="line"><span class="keyword">@import</span> <span class="string">"globals/colors"</span>;</span><br><span class="line"><span class="keyword">@import</span> <span class="string">"globals/fonts"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* components.less */</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">"components/tabs"</span>;</span><br><span class="line"><span class="keyword">@import</span> <span class="string">"components/modals"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* sections.less */</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">"sections/header"</span>;</span><br><span class="line"><span class="keyword">@import</span> <span class="string">"sections/footer"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* main.less */</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">"app/main"</span>;</span><br></pre></td></tr></table></figure>
<p><a name="naming"></a></p>
<h2 id="命名规则"><a href="#命名规则" class="headerlink" title="命名规则"></a>命名规则</h2><p>CSS的命名规则</p>
<ol>
<li>统一处理：建议在这个位置统一调用背景图（这里指多个布局或模块或元件共用的图）和清除浮动（这里指通用性较高的布局、模块、元件内的清除）等统一设置处理的样式！</li>
<li>布局（grid）（.g-）：将页面分割为几个大块，通常有头部、主体、主栏、侧栏、尾部等！</li>
<li>模块（module）（.m-）：通常是一个语义化的可以重复使用的较大的整体！比如导航、登录、注册、各种列表、评论、搜索等！</li>
<li>元件（unit）（.u-）：通常是一个不可再分的较为小巧的个体，通常被重复用于各种模块中！比如按钮、输入框、loading、图标等！</li>
<li>功能（function）（.f-）：为方便一些常用样式的使用，我们将这些使用率较高的样式剥离出来，按需使用，通常这些选择器具有固定样式表现，比如清除浮动等！不可滥用！</li>
<li>皮肤（skin）（.s-）：如果你需要把皮肤型的样式抽离出来，通常为文字色、背景色（图）、边框色等，非换肤型网站通常只提取文字色！非换肤型网站不可滥用此类！</li>
<li>状态（.z-）：为状态类样式加入前缀，统一标识，方便识别，她只能组合使用或作为后代出现（.u-ipt.z-dis{}，.m-list li.z-sel{}），具体详见命名规则的扩展相关项。<br>功能类和皮肤类样式为表现化的样式，请不要滥用！以上顺序可以按需求适当调整。</li>
</ol>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 统一清除浮动 */</span></span><br><span class="line"><span class="selector-class">.g-bdc</span><span class="selector-pseudo">:after</span>,</span><br><span class="line"><span class="selector-class">.m-dimg</span> <span class="selector-tag">ul</span><span class="selector-pseudo">:after</span>,</span><br><span class="line"><span class="selector-class">.u-tab</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">visibility</span>: hidden;</span><br><span class="line">  <span class="attribute">clear</span>: both;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">'.'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.g-bdc</span>,</span><br><span class="line"><span class="selector-class">.m-dimg</span> <span class="selector-tag">ul</span>,</span><br><span class="line"><span class="selector-class">.u-tab</span> &#123;</span><br><span class="line">  <span class="attribute">zoom</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 布局 */</span></span><br><span class="line"><span class="selector-class">.g-sd</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 模块 */</span></span><br><span class="line"><span class="selector-class">.m-logo</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 元件 */</span></span><br><span class="line"><span class="selector-class">.u-btn</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 功能 */</span></span><br><span class="line"><span class="selector-class">.f-tac</span> &#123;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 皮肤 */</span></span><br><span class="line"><span class="selector-class">.s-fc</span>,</span><br><span class="line"><span class="selector-tag">a</span><span class="selector-class">.s-fc</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a name="formatting"></a></p>
<h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><ul>
<li>使用 2 个空格作为缩进。</li>
<li>类名建议使用破折号代替驼峰法。</li>
<li>在一个规则声明中应用了多个选择器时，每个选择器独占一行。</li>
<li>在规则声明的左大括号 <code>{</code> 前加上一个空格。</li>
<li>在属性的冒号 <code>:</code> 后面加上一个空格，前面不加空格。</li>
<li>规则声明的右大括号 <code>}</code> 独占一行。</li>
<li>规则声明之间用空行分隔开。</li>
</ul>
<p><a name="comments"></a></p>
<h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2><ul>
<li>建议使用行注释代替块注释。</li>
<li>建议注释独占一行。避免行末注释。</li>
<li>给没有自注释的代码写上详细说明，比如：<ul>
<li>为什么用到了 z-index<br>例如，// modals are 6000, saving messages are 5500, header is 2000</li>
<li>兼容性处理或者针对特定浏览器的 hack</li>
</ul>
</li>
</ul>
<p><a name="order"></a></p>
<h2 id="书写顺序"><a href="#书写顺序" class="headerlink" title="书写顺序"></a>书写顺序</h2><p><a name="less-order"></a></p>
<h3 id="LESS书写顺序"><a href="#LESS书写顺序" class="headerlink" title="LESS书写顺序"></a>LESS书写顺序</h3><ol>
<li>Extend （扩展）</li>
<li>Mixins (混合)</li>
<li>常规样式，在extends和mixins之后添加常规样式允许我们正确地覆盖这些属性（如果需要）。</li>
<li>伪元素和伪类样式</li>
<li>嵌套样式<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.weather</span> &#123;</span><br><span class="line">  <span class="selector-tag">&amp;</span><span class="selector-pseudo">:extend(.module)</span>;</span><br><span class="line">  <span class="selector-class">.transition</span>(all <span class="number">0.3s</span> ease-out);</span><br><span class="line">  <span class="attribute">background</span>: LightCyan;</span><br><span class="line">  <span class="selector-tag">&amp;</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: DarkCyan;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">&amp;</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">""</span>;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">  &#125;</span><br><span class="line">  &gt; <span class="selector-tag">h3</span> &#123;</span><br><span class="line">    <span class="selector-class">.transform</span>(rotate(<span class="number">90deg</span>));</span><br><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid white;</span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><a name="rule-order"></a></p>
<h3 id="属性书写顺序"><a href="#属性书写顺序" class="headerlink" title="属性书写顺序"></a>属性书写顺序</h3><table>
<thead>
<tr>
<th>→</th>
<th>显示属性</th>
<th>自身属性</th>
<th>文本属性和其他修饰</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>display</td>
<td>width</td>
<td>font</td>
</tr>
<tr>
<td></td>
<td>visibility</td>
<td>height</td>
<td>text-align</td>
</tr>
<tr>
<td></td>
<td>position</td>
<td>margin</td>
<td>text-decoration</td>
</tr>
<tr>
<td></td>
<td>float</td>
<td>padding</td>
<td>vertical-align</td>
</tr>
<tr>
<td></td>
<td>clear</td>
<td>border</td>
<td>white-space</td>
</tr>
<tr>
<td></td>
<td>list-style</td>
<td>overflow</td>
<td>color</td>
</tr>
<tr>
<td></td>
<td>top</td>
<td>min-width</td>
<td>background</td>
</tr>
</tbody>
</table>
<p><a name="good"></a></p>
<h2 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h2><ul>
<li>使用变量命名常用的数字和颜色</li>
</ul>
<p><a name="bad"></a></p>
<h2 id="典型错误"><a href="#典型错误" class="headerlink" title="典型错误"></a>典型错误</h2><ul>
<li>不要使用 ID 选择器。</li>
<li>不要使用!important</li>
<li>不要使用浏览器私有前缀，使用autoprefixer替代。</li>
<li><p>嵌套选择器的深度不要超过 3 层！</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.page-container</span> &#123;</span><br><span class="line">  <span class="selector-class">.content</span> &#123;</span><br><span class="line">    <span class="selector-class">.profile</span> &#123;</span><br><span class="line">      <span class="comment">// STOP!</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>不要使用class作为javascript钩子，在react中可使用refs替代javascript钩子。</p>
</li>
<li>嵌套选择器的行数不要超过 50 行!</li>
</ul>
<p><a name="reference"></a></p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="https://github.com/Zhangjd/css-style-guide" target="_blank" rel="noopener">Airbnb CSS / Sass 指南</a></li>
<li><a href="http://nec.netease.com/standard/css-sort.html" target="_blank" rel="noopener">Netease CSS规范</a></li>
<li><a href="https://css-tricks.com/sass-style-guide/" target="_blank" rel="noopener">Sass Style Guide</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://nsfi.github.io/blog/blog/2017/11/20/Quick-Start/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="giflee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="网易先知&&网易七鱼前端团队博客">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/11/20/Quick-Start/" itemprop="url">如何发表文章</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-20T15:41:32+08:00">
                2017-11-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="快速开始"><a href="#快速开始" class="headerlink" title="快速开始"></a>快速开始</h2><h3 id="获取源码"><a href="#获取源码" class="headerlink" title="获取源码"></a>获取源码</h3><p>代码托管在<code>NSFI</code>组下的<code>sf-blog-source</code>中</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/NSFI/sf-blog-source.git</span><br></pre></td></tr></table></figure>
<h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install</span><br></pre></td></tr></table></figure>
<h3 id="创建文章"><a href="#创建文章" class="headerlink" title="创建文章"></a>创建文章</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">'文章title'</span></span><br></pre></td></tr></table></figure>
<h3 id="本地服务预览"><a href="#本地服务预览" class="headerlink" title="本地服务预览"></a>本地服务预览</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<h3 id="生成静态文件"><a href="#生成静态文件" class="headerlink" title="生成静态文件"></a>生成静态文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo g</span><br></pre></td></tr></table></figure>
<h3 id="部署到服务器"><a href="#部署到服务器" class="headerlink" title="部署到服务器"></a>部署到服务器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo d</span><br></pre></td></tr></table></figure>
<p>为了保证统一，部署之前最好将代码推到github库中去以后再执行<code>hexo d</code>。</p>
<p>More info: <a href="https://hexo.io/zh-cn/docs/index.html" target="_blank" rel="noopener">hexo文档</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">giflee</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/blog/archives/">
              
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">giflee</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/blog/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/blog/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/blog/js/src/motion.js?v=5.1.3"></script>



  
  

  

  


  <script type="text/javascript" src="/blog/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
